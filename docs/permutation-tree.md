---
documentation_of: //structure/others/permutation-tree.hpp
---

## 概要

順列 $A$ に対応する順列木(Permutation Tree, 析合树) を構築する.

$ \max\limits_{l \leq i \leq r} A_i - \min\limits_{l \leq i \leq r} A_i = r-l$ が成立するような $[l, r]$ を良い連続部分列と定義する. この良い連続部分列を効率的に求める.

順列木のそれぞれのノードはいくつかのタイプに分類される. 定義を以下に示す.

* LEAF: 葉ノード. 数列のある $1$ 要素に対応する.
* JOIN: そのノードが持つ子の列から、連続する $2$ つ以上の子を選んだときに全てが良い連続部分列となる. 
* CUT: そのノードが持つ子の列から、どの連続する $2$ つ以上の子を選んでも良い連続部分列にはならない.

## 使い方

* `build(A)`: 順列 `A` に対応する順列木を返す. `A` には $0$ 以上 $n - 1$ 以下の値が $1$ つずる含まれることを要求する. `Node` には、ノードのタイプ `type`, そのノードに対応する順列の index の区間 $[l, r)$, ノードに含まれる要素の値 `[min_v, max_v)`, 子 `ch` が格納される.

## 計算量

- $O(n \log n)$
