---
documentation_of: //graph/tree/pmormq-lowest-common-ancestor.hpp
---

## 概要
オイラーツアーと±1RMQ によって最小共通祖先を求める.

辺属性のオイラーツアーをする. すべての頂点について, その頂点 $k$ に最初に到達した時刻 $in[k]$ と深さ $dep[k]$ を求めておく. 頂点 $u, v$ の最小共通祖先は区間 $[in[u], in[v]]$ の要素のうち深さが最小となる頂点である.

スパーステーブルを用いると前計算 $O(V \log V)$, クエリ $O(1)$ となるが, $dep[k]$ 隣接する要素の差がちょうど $1$ であることを利用した ±1RMQ を用いると前計算 $O(V)$, クエリ $O(1)$ となる.

## 使い方

* `build()`: 構築する.
* `lca(u, v)`: 頂点 `u`, `v` の最小共通祖先(LCA)を返す.

## 計算量

* `build()`: $O(V)$
* `lca()`: $O(1)$
