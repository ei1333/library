---
documentation_of: //graph/others/offline-dag-reachability.hpp
---

## 概要

DAG(閉路のない有向グラフ) が与えられたとき, ある頂点からある頂点に到達できるかどうかを調べるクエリをビット並列により処理する. ちなみに, 閉路のあるグラフの場合は強連結成分分解して, 各強連結成分を縮約することで DAG に帰着される.

トポロジカルソートして頂点をトポロジカル順に見ると, ある頂点からどの頂点に到達できるかを判定できる. このとき, 各 bit を $1$ つのクエリに対応させて到達可能性を判定すると, ビット並列により処理できることとなり高速化が見込める.

## 使い方

* `offline_dag_reachability(g, qs)`: DAG `g` について, `qs` の各クエリについて頂点 `qs[i].first` から `qs[i].second` に到達できるか判定し, 到達できる場合は `1`, できない場合は `0` を格納して返す.

## 計算量

$O(\frac {(E + V) Q} {B})$

$V$: 頂点数, $E$: 辺の本数, $Q$ クエリの個数, $B$: ワードサイズ 
